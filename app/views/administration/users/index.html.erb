<% content_for :breadcrumbs do %>
  <ul class="breadcrumb">
    <li class="active">
      <%= link_to "Administration", administration_users_path %>
    </li>
  </ul>
<% end %>

<div class="page-header">
  <h1>Liste des clients
    <%= link_to raw('<i class="icon-user icon-white"></i> Nouveau Client'), new_administration_user_path, :class => "btn btn-primary pull-right" %>
  </h1>
</div>
<table class="table table-striped table-bordered table-condensed">
  <thead>
    <tr>
      <td>Name</td>
      <td># Contrats</td>
      <td># Fichiers</td>
      <td>Espace disque</td>
      <td>Connection</td>
      <td>Actions</td>
    </tr>
  </thead>
  <tbody>
    <% @users.each do |user| %>
      <tr>
        <td>
          <i class="icon-user"></i>
          <%= link_to print_upto( user.name_tag, 30), administration_user_path(user) %>
        </td>
        <td><%= user.contracts.size %></td>
        <td><%= user.file_number %></td>
        <td><%= number_to_human_size user.disk_space %></td>
        <td></td>
        <td>
          <div class="btn-group pull-right">
            <%= link_to raw('<i class="icon-eye-open"></i>'), administration_user_path(user),
              :class => "btn btn-mini valign-top",
              :title => "Voir, ajouter, supprimer les contrats et fichiers de #{user.name_tag}", :rel => "tooltip"
            %>
            <%= link_to raw('<i class="icon-edit"></i>'), edit_administration_user_path(user),
              :class => "btn btn-mini",
              :title => "Modifier les informations client", :rel => "tooltip"
            %>
          <% if user.is_admin? %>
            <a href="#" title="Impossible de supprimer un Administrateur" class="btn btn-danger btn-mini disabled" rel="tooltip">
              <i class="icon-trash icon-white"></i>
            </a>
          <% else %>
            <%= link_to( raw('<i class="icon-trash icon-white"></i>'),
                administration_user_path(user),
                :method => :delete,
                :confirm => "Êtes vous sûr de vouloir supprimer l'utilisateur #{user.name_tag.upcase} ?",
                :class => "btn btn-danger btn-mini",
                :title => "Supprimer l'utilisateur", :rel => "tooltip")
            %>
          <% end -%>
          </div>
        </td>
      </tr>
    <% end -%>
  </tbody>
</table>
