<% content_for :breadcrumbs do %>
  <ul class="breadcrumb">
    <li>
      <%= link_to "Administration", administration_users_path %>
      <span class="divider">/</span>
    </li>
    <li>
      <%= link_to "Utilisateur : #{@user.name_tag}", administration_user_path(@user) %>
      <span class="divider">/</span>
    </li>
    <li class="active">
      <%= link_to "Contrat : #{@contract.name.capitalize}", administration_user_contract_path(@user, @contract) %>
    </li>
  </ul>
<% end %>

<div class="page-header">
  <h2>
    Contrat "<%= @contract.name %>"
    <small> appartenant à <%= @user.name_tag %></small>
  </h2>
</div>
<% if @contract.documents.empty? %>
  Aucun fichier : <%= link_to "Ajouter un fichier", new_administration_user_contract_document_path(@user,@contract) %>
<% else %>
  <table class="table table-striped table-bordered table-condensed">
    <thead>
      <tr>
        <th>Fichier</th>
        <th>Taille</th>
        <th>Modifié</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @contract.documents.each do |document| %>
        <tr>
          <td><%= link_to document.file_name.capitalize, administration_user_contract_document_path(@user, @contract, document) %></td>
          <td><%= number_to_human_size(document.uploaded_file_file_size) %></td>
          <td><%= document.uploaded_file_updated_at %></td>
          <td>
            <div class="btn-group pull-right">
              <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">Actions
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                <li><%= link_to 'Télécharger', admin_download_url(document) %></li>
                <li><%= link_to 'Voir', administration_user_contract_document_path(@user, @contract, document) %></li>
                <li><%= link_to 'Editer', edit_administration_user_contract_document_path(@user, @contract, document) %></li>
                <li><%= link_to 'Supprimer', administration_user_contract_document_path(@user, @contract, document), :method => :delete, :confirm => "Êtes vous sûr de vouloir supprimer le fichier #{document.file_name.capitalize}" %></li>
              </ul>
            </div>
          </td>
        </tr>
      <% end -%>
    </tbody>
  </table>
<% end %>
<div class="form-actions">
  <div class="btn-group">
    <%= link_to 'Retour', administration_user_path(@user), :class => 'btn'  %>
    <%= link_to 'Modifier', edit_administration_user_contract_path(@user, @contract), :class => 'btn' %>

    <%= link_to "Ajouter un fichier", new_administration_user_contract_document_path(@user,@contract), :class => "btn btn-primary" %>
    <%= link_to 'Supprimer Contrat', administration_user_contract_path(@user, @contract), :method => 'delete', :confirm => 'Etes vous sur ?', :class => 'btn btn-danger' %>
  </div>
</div>
